# .github/workflows/python_lint.yml

name: Python Code Quality Check # 給這個自動化任務取個名字

# 什麼時候觸發這個任務？
on:
  push: # 只要你把程式碼推送到 GitHub (push)
    branches: [ "main" ] # 針對 main 分支
  pull_request: # 只要有人發送 Pull Request (PR)
    branches: [ "main" ]

jobs: # 這是要執行的工作清單
  linting: # 這個工作的名字叫程式碼檢查
    runs-on: ubuntu-latest # 在一個新的、乾淨的 Linux 虛擬機上運行

    steps: # 執行的步驟
    - uses: actions/checkout@v4 # 步驟 1: 把你的 GitHub 程式碼抓下來
    
    - name: Set up Python # 步驟 2: 安裝 Python 環境
      uses: actions/setup-python@v5
      with:
        python-version: '3.x' # 使用最新的 Python 3 版本

    - name: Install dependencies and Flake8
      run: |
        pip install flake8
        # 使用 if 語句檢查 requirements.txt 是否存在，以防萬一
        if [ -f requirements.txt ]; then
          pip install -r requirements.txt
        else
          echo "requirements.txt not found. Continuing with only Flake8."
        fi

    - name: Run Flake8 check # 步驟 4: 運行 Flake8 掃描 (這是最重要的檢查)
      run: |
        # --exit-zero: 讓這個步驟就算失敗也不會讓整個任務停止 (新手可以先這樣設)
        # --show-source: 顯示是哪一行程式碼出錯
        # . : 檢查所有檔案
        flake8 . --show-source
